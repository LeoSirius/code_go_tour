(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{383:function(e,t,n){},748:function(e,t,n){},750:function(e,t,n){"use strict";n.r(t);var a=n(7),r=n(0),o=n.n(r),i=n(32),c=n.n(i),s=n(36),d=n(41),l=n(43),u=n(42),p=n(755),h=n(89),j=p.a.Header,b=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(s.a)(this,n),t.call(this,e)}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.props.repoList;return Object(a.jsxs)(j,{className:"header",children:[Object(a.jsx)("div",{className:"logo"}),t.length>0&&Object(a.jsx)(h.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:[String(t[0].id)],children:t.map((function(t){return Object(a.jsx)(h.a.Item,{onClick:function(){return e.props.updateCurRepoID(t.id)},children:t.name},t.id)}))})]})}}]),n}(o.a.Component),f=h.a.SubMenu,m=(p.a.Header,p.a.Content,p.a.Sider),g=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).selectFile=function(e){r.props.updateCurFilePath(e.path_in_repo)},r.renderTree=function(e){return e.filter((function(e){return"."!==e.name[0]})).map((function(e){return e.is_dir?Object(a.jsx)(f,{title:e.name,children:e.children&&e.children.length>0&&r.renderTree(e.children)},e.path_in_repo):Object(a.jsx)(h.a.Item,{onClick:function(){return r.selectFile(e)},children:e.name},e.path_in_repo)}))},r.state={direntTree:[]},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.direntTree;return console.log("direntTree = ",e),Object(a.jsx)(m,{width:300,className:"site-layout-background",children:Object(a.jsx)(h.a,{mode:"inline",defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],style:{height:"100%",borderRight:0},children:e.length>0&&this.renderTree(e)})})}}]),n}(o.a.Component),O=n(232),v=n.n(O),x=n(233),y=n.n(x),C=n(761),R=n(756),k=(n(383),h.a.SubMenu,p.a.Header,p.a.Content),S=(p.a.Sider,function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).flatten=function(e,t){return"string"===typeof t?e+t:o.a.Children.toArray(t.props.children).reduce(a.flatten,e)},a.HeadingRenderer=function(e){var t=o.a.Children.toArray(e.children).reduce(a.flatten,""),n=encodeURIComponent(t);return o.a.createElement("h"+e.level,{id:n},e.children)},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.fileContent;return Object(a.jsx)(k,{className:"site-layout-background",style:{padding:24,margin:0,minHeight:window.innerHeight,backgroundColor:"white"},children:Object(a.jsx)(v.a,{className:"markdown-body",source:e,plugins:[y.a],renderers:{heading:this.HeadingRenderer,code:function(e){var t=e.language,n=e.value;return Object(a.jsx)(C.a,{style:R.a,language:t,children:n,showLineNumbers:!0,showInlineLineNumbers:!0})}}})})}}]),n}(o.a.Component)),L=n(759),w=p.a.Sider,U=L.a.Link,D=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var r;return Object(s.a)(this,n),(r=t.call(this,e)).renderTOC=function(e){return e.map((function(e){return e.children&&e.children.length>0?Object(a.jsx)(U,{href:"#"+encodeURIComponent(e.name),title:e.name,children:r.renderTOC(e.children)}):Object(a.jsx)(U,{href:"#"+encodeURIComponent(e.name),title:e.name})}))},r}return Object(d.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.toc;return Object(a.jsx)(w,{width:200,className:"site-layout-background",children:Object(a.jsx)(h.a,{mode:"inline",defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],style:{height:"100%",borderRight:0},children:Object(a.jsx)(L.a,{children:this.renderTOC(e)})})})}}]),n}(o.a.Component),T=n(235),M=n.n(T),I=n(150),N=n.n(I),F="http://39.106.229.224",A=M.a.create(),E={login:function(e,t,n){var a=F+"/login2?next="+n,r=new N.a;return r.append("username",e),r.append("password",t),A.post(a,r)},adminListRepos:function(e,t){return A.get("http://39.106.229.224/api/v1/admin/repos")},adminAddRepo:function(e,t){var n=new N.a;return n.append("name",e),n.append("url",t),A.post("http://39.106.229.224/api/v1/admin/repos",n)},adminUpdateRepo:function(e,t,n){var a=F+"/api/v1/admin/repos/"+e,r=new N.a;return""!==t&&r.append("name",t),""!==n&&r.append("url",n),A.put(a,r)},adminDeleteRepo:function(e){var t=F+"/api/v1/admin/repos/"+e;return A.delete(t)},listRepos:function(){return A.get("http://39.106.229.224/api/v1/repos/")},getRepoDirentTree:function(e){var t=F+"/api/v1/repos/"+e+"/dirent-tree";return A.get(t)},getRepoFile:function(e,t){var n=F+"/api/v1/repos/"+e+"/file",a={path:t};return A.get(n,{params:a})},getGithubMarkdownRendered:function(e){console.log("fileString = ",e);var t={text:e};return A.post("https://api.github.com/markdown",t)}},_=p.a.Footer,P=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).updateContent=function(){var e=a.state,t=e.curRepoID,n=e.curFilePath;E.getRepoFile(t,n).then((function(e){var t=e.data.content;if(!n.endsWith(".md")){var r=n.split(".");t="```"+r[r.length-1]+"\n"+t+"\n```"}var o=[];e.data.toc.filter((function(e){return 2===e.level||3===e.level})).map((function(e){if(2===e.level){var t=e;return t.children=[],void o.push(t)}3!==e.level||o[o.length-1].children.push(e)})),a.setState({fileContent:t,toc:o})}))},a.updateDirentTree=function(){var e=a.state.curRepoID;E.getRepoDirentTree(e).then((function(e){a.setState({direntTree:e.data.dirent_tree})}))},a.updateCurFilePath=function(e){console.log("in updateCurFilePath newPath = ",e),a.setState({curFilePath:e},(function(){a.updateContent()}))},a.updateCurRepoID=function(e){a.setState({curRepoID:e},(function(){a.updateContent(),a.updateDirentTree()}))},a.state={repoList:[],curRepoID:0,curFilePath:"README.md",direntTree:[],toc:[]},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;E.listRepos().then((function(t){e.setState({repoList:t.data.repo_list,curRepoID:t.data.repo_list.length>0?t.data.repo_list[0].id:0},(function(){e.updateContent(),e.updateDirentTree()}))})).catch((function(e){}))}},{key:"render",value:function(){var e=this.state,t=e.repoList,n=e.curRepoID,r=e.fileContent,o=e.direntTree,i=e.toc;return Object(a.jsxs)(p.a,{children:[Object(a.jsx)(b,{curRepoID:n,repoList:t,updateCurRepoID:this.updateCurRepoID}),Object(a.jsxs)(p.a,{children:[n>0&&Object(a.jsx)(g,{updateCurFilePath:this.updateCurFilePath,curRepoID:n,direntTree:o}),Object(a.jsx)(p.a,{style:{padding:"0 24px 24px"},children:n>0&&Object(a.jsx)(S,{fileContent:r})}),n>0&&Object(a.jsx)(D,{toc:i})]}),Object(a.jsx)(_,{style:{textAlign:"center"},children:"Ant Design \xa92018 Created by Ant UED"})]})}}]),n}(o.a.Component),H=n(762),K=n(175),B=n(757),z=n(260),J=n(765),q=n(101),G=n(48),W=n(758),Q=n(764),V=n(766),X=n(760),Y=n(763),Z={getErrMsg:function(e){return e.response?e.response.data&&e.response.data.message?e.response.data.message:e.response.statusText:"network error"}},$=p.a.Header,ee=function(e){var t=o.a.useState(!1),n=Object(q.a)(t,2),r=n[0],i=n[1],c=o.a.useState(!1),s=Object(q.a)(c,2),d=s[0],l=s[1],u=o.a.useState(""),p=Object(q.a)(u,2),h=p[0],j=p[1],b=o.a.useState(""),f=Object(q.a)(b,2),m=f[0],g=f[1],O=o.a.useState(""),v=Object(q.a)(O,2),x=v[0],y=v[1];return Object(a.jsxs)($,{className:"site-layout-background",style:{paddingLeft:"20px"},children:[Object(a.jsx)(G.a,{type:"primary",onClick:function(){i(!0)},children:"Add"}),Object(a.jsxs)(W.a,{title:"Add a git repository",visible:r,onOk:function(){""!==m&&""!==h?(l(!0),E.adminAddRepo(h,m).then((function(t){e.addRepo(t.data),i(!1),l(!1),z.a.success({message:"repository added"})})).catch((function(e){z.a.error({message:Z.getErrMsg(e)})}))):y("name and url are required")},confirmLoading:d,onCancel:function(){i(!1)},children:[Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(V.a,{span:3,children:"name"}),Object(a.jsx)(V.a,{span:20,children:Object(a.jsx)(X.a,{onChange:function(e){j(e.target.value),y("")},value:h,placeholder:"display name",style:{marginBottom:"10px"}})})]}),Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(V.a,{span:3,children:"url"}),Object(a.jsx)(V.a,{span:20,children:Object(a.jsx)(X.a,{onChange:function(e){g(e.target.value),y("")},value:m,placeholder:"url of git repo"})})]}),x&&Object(a.jsx)(Y.a,{message:x,type:"error",style:{marginTop:"15px"}})]})]})},te=function e(t){Object(s.a)(this,e);var n=new Object;return n.key=t.id,n.name=t.name,n.url=t.url,n},ne=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).updateRepo=function(){var e=a.state,t=e.repoName,n=e.repoURL;a.props.updateRepo(a.props.repoToUpdate.key,t,n)},a.handleNameChange=function(e){a.setState({repoName:e.target.value,errMsg:""})},a.handleRepoURLChange=function(e){a.setState({repoURL:e.target.value,errMsg:""})},a.state={repoName:"",repoURL:"",errMsg:""},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){console.log("in mounttututut this.props = ",this.props),this.setState({repoName:this.props.repoToUpdate.name,repoURL:this.props.repoToUpdate.url})}},{key:"render",value:function(){console.log("renrenrnernenrender"),console.log("this.state = ",this.state);var e=this.state,t=e.repoName,n=e.repoURL,r=e.errMsg;return Object(a.jsx)("div",{children:Object(a.jsxs)(W.a,{title:"Update a git repository",visible:this.props.visible,onOk:this.updateRepo,confirmLoading:this.props.confirmLoading,onCancel:this.props.onCancel,children:[Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(V.a,{span:3,children:"name"}),Object(a.jsx)(V.a,{span:20,children:Object(a.jsx)(X.a,{onChange:this.handleNameChange,value:t,style:{marginBottom:"10px"}})})]}),Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(V.a,{span:3,children:"url"}),Object(a.jsx)(V.a,{span:20,children:Object(a.jsx)(X.a,{onChange:this.handleRepoURLChange,value:n})})]}),r&&Object(a.jsx)(Y.a,{message:r,type:"error",style:{marginTop:"15px"}})]})})}}]),n}(o.a.Component),ae=B.a.Column,re=p.a.Content,oe=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).addRepo=function(e){a.setState({repoList:[].concat(Object(K.a)(a.state.repoList),[new te(e)])})},a.deleteRepo=function(e){E.adminDeleteRepo(e.key).then((function(t){var n=a.state.repoList.filter((function(t){return t.key!==e.key}));a.setState({repoList:n}),z.a.success({message:"repository deleted"})})).catch((function(e){console.log(e),z.a.error({message:Z.getErrMsg(e)})}))},a.updateRepo=function(e,t,n){E.adminUpdateRepo(e,t,n).then((function(t){var n=new te(t.data),r=Object(K.a)(a.state.repoList);r.forEach((function(t){t.key===e&&(t.name=n.name,t.url=n.url)})),a.setState({repoList:r,isShowUpdateRepo:!1,modalUpdateConfirmLoading:!1}),z.a.success({message:"repository updated"})})).catch((function(e){z.a.error({message:Z.getErrMsg(e)})}))},a.cancelUpdateModal=function(){console.log("in cancal"),a.setState({isShowUpdateRepo:!1})},a.showModalUpdateRepo=function(e){a.setState({repoToUpdate:e},(function(){a.setState({isShowUpdateRepo:!0})}))},a.state={repoList:[],isShowUpdateRepo:!1,modalUpdateConfirmLoading:!1,repoToUpdate:null},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;E.adminListRepos(0,0).then((function(t){e.setState({repoList:t.data.repo_list.map((function(e){return new te(e)}))})})).catch((function(e){z.a.error({message:Z.getErrMsg(e)})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.repoList,r=t.isShowUpdateRepo,o=t.modalUpdateConfirmLoading,i=t.repoToUpdate;return Object(a.jsxs)("div",{children:[Object(a.jsx)(ee,{addRepo:this.addRepo}),Object(a.jsx)(re,{style:{margin:"0 16px",paddingTop:"20px"},children:Object(a.jsxs)(B.a,{dataSource:n,pagination:!1,children:[Object(a.jsx)(ae,{title:"Name",dataIndex:"name"},"name"),Object(a.jsx)(ae,{title:"URL",dataIndex:"url"},"url"),Object(a.jsx)(ae,{title:"Action",render:function(t,n){return Object(a.jsxs)(J.b,{size:"middle",children:[Object(a.jsx)("a",{onClick:function(){return e.showModalUpdateRepo(t)},children:"Update"}),Object(a.jsx)("a",{onClick:function(){return e.deleteRepo(t)},children:"Delete"})]},t.key)}},"action")]})}),r&&Object(a.jsx)(ne,{visible:r,updateRepo:this.updateRepo,confirmLoading:o,onCancel:this.cancelUpdateModal,repoToUpdate:i})]})}}]),n}(o.a.Component),ie=(n(748),p.a.Footer),ce=p.a.Sider,se=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={collapsed:!1},e.onCollapse=function(t){console.log(t),e.setState({collapsed:t})},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.state.collapsed;return Object(a.jsxs)(p.a,{style:{minHeight:"100vh"},children:[Object(a.jsxs)(ce,{collapsible:!0,collapsed:e,onCollapse:this.onCollapse,children:[Object(a.jsx)("div",{className:"admin-logo"}),Object(a.jsx)(h.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline",children:Object(a.jsx)(h.a.Item,{icon:Object(a.jsx)(H.a,{}),children:"Repositories"},"1")})]}),Object(a.jsxs)(p.a,{className:"site-layout",children:[Object(a.jsx)(oe,{}),Object(a.jsx)(ie,{style:{textAlign:"center"},children:"Ant Design \xa92018 Created by Ant UED"})]})]})}}]),n}(o.a.Component),de=function(e){Object(l.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).state={route:window.location.pathname},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.addEventListener("hashchange",(function(){e.setState({route:window.location.pathname})}))}},{key:"render",value:function(){var e;switch(console.log("this.staete = ",this.state),this.state.route){case"/":e=P;break;case"/admin":e=se;break;default:e=P}return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(e,{})})}}]),n}(o.a.Component),le=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,767)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))};n(749);c.a.render(Object(a.jsx)(de,{}),document.getElementById("root")),le()}},[[750,1,2]]]);
//# sourceMappingURL=main.ec486ba6.chunk.js.map